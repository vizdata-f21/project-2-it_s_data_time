---
title: "peopleeda"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
library(dplyr)
library(stringr)
library(janitor)
library(tidytext)
library(igraph)
library(tidygraph)
library(ggraph)

#library(network)
```


```{r}
ratings <- read_csv("../data/IMDbratings.csv")
movies <- read_csv("../data/IMDb movies.csv")
title_principles <- read_csv("../data/IMDb title_principals.csv")
```

```{r}
people <-movies%>%
  mutate(century = case_when(
    year >=2000 ~ "1",
    year>= 900 & year <2000 ~ "0"
  ))  


```

 
### Filtering for most frequent actors by Director Selected.

[ ] A can be renamed to a temporary variable that makes it easier to keep track of the changing dataset. 

[ ] Script for filtering based on director,actor or writer can be a function call. 
```{r}
A<-people%>%
  filter(director == "Spike Lee")%>%
  select(actors)



actorsconnected<-unnest_tokens(A, split, actors, token = str_split, pattern = ",")%>%
   group_by(split)%>%
  count()%>%
  arrange(desc(n))%>%
  head(10)

actorsconnected$node = replicate(10, "Spike Lee")

actorsconnected<-actorsconnected%>%
  rename(weight = n)%>%
  select(node,split, weight)

B<-people%>%
  filter(director == "Spike Lee")%>%
  select(writer)



writorsconnected<-unnest_tokens(B, split, writer, token = str_split, pattern = ",")%>%
   group_by(split)%>%
  count()%>%
  arrange(desc(n))%>%
  head(20)

```


```{r}

bigram_graph<-actorsconnected%>%
  graph_from_data_frame(directed = TRUE)


bigram_graph

is_weighted(bigram_graph)


ggraph(bigram_graph) +
  geom_edge_link() +
  geom_node_point() 

plot(bigram_graph)
```

